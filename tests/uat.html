<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾…åŠäº‹é¡¹åº”ç”¨ - ç”¨æˆ·éªŒæ”¶æµ‹è¯•</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .uat-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
        }
        .uat-panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .uat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .uat-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        .uat-card:hover {
            border-color: #007bff;
            transform: translateY(-2px);
        }
        .uat-card h3 {
            margin-top: 0;
            color: #495057;
        }
        .uat-card.completed {
            border-color: #28a745;
            background: #d4edda;
        }
        .uat-card.failed {
            border-color: #dc3545;
            background: #f8d7da;
        }
        .uat-progress {
            background: #e9ecef;
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin: 20px 0;
        }
        .uat-progress-bar {
            background: linear-gradient(45deg, #007bff, #28a745);
            height: 100%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        .uat-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .uat-metric {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e9ecef;
        }
        .uat-metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
        }
        .uat-metric-label {
            font-size: 14px;
            color: #6c757d;
            margin-top: 5px;
        }
        .uat-actions {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .uat-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .uat-btn.primary {
            background: #007bff;
            color: white;
        }
        .uat-btn.success {
            background: #28a745;
            color: white;
        }
        .uat-btn.warning {
            background: #ffc107;
            color: #212529;
        }
        .uat-btn.danger {
            background: #dc3545;
            color: white;
        }
        .uat-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .uat-test-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
        .uat-test-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #28a745;
        }
        .uat-test-item label {
            flex: 1;
            cursor: pointer;
            user-select: none;
        }
        .uat-test-item.completed {
            background: #d4edda;
            border-color: #c3e6cb;
        }
        .uat-test-item.completed label {
            text-decoration: line-through;
            color: #6c757d;
        }
        .uat-notes {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
        }
        .uat-notes h4 {
            margin-top: 0;
            color: #856404;
        }
        .uat-notes textarea {
            width: 100%;
            min-height: 100px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            resize: vertical;
            font-family: inherit;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="uat-container">
            <h1>å¾…åŠäº‹é¡¹åº”ç”¨ - ç”¨æˆ·éªŒæ”¶æµ‹è¯•</h1>
            
            <div class="uat-panel">
                <h2>æµ‹è¯•æ¦‚è§ˆ</h2>
                <div class="uat-progress">
                    <div id="progress-bar" class="uat-progress-bar" style="width: 0%">0%</div>
                </div>
                <div class="uat-summary">
                    <div class="uat-metric">
                        <div id="total-tests" class="uat-metric-value">0</div>
                        <div class="uat-metric-label">æ€»æµ‹è¯•é¡¹</div>
                    </div>
                    <div class="uat-metric">
                        <div id="completed-tests" class="uat-metric-value">0</div>
                        <div class="uat-metric-label">å·²å®Œæˆ</div>
                    </div>
                    <div class="uat-metric">
                        <div id="failed-tests" class="uat-metric-value">0</div>
                        <div class="uat-metric-label">å¤±è´¥</div>
                    </div>
                    <div class="uat-metric">
                        <div id="pass-rate" class="uat-metric-value">0%</div>
                        <div class="uat-metric-label">é€šè¿‡ç‡</div>
                    </div>
                </div>
                <div class="uat-actions">
                    <button class="uat-btn primary" onclick="startUAT()">å¼€å§‹æµ‹è¯•</button>
                    <button class="uat-btn success" onclick="exportResults()">å¯¼å‡ºç»“æœ</button>
                    <button class="uat-btn warning" onclick="resetTests()">é‡ç½®æµ‹è¯•</button>
                    <button class="uat-btn danger" onclick="generateReport()">ç”ŸæˆæŠ¥å‘Š</button>
                </div>
            </div>

            <div class="uat-grid">
                <!-- åŸºç¡€åŠŸèƒ½æµ‹è¯• -->
                <div class="uat-card" id="basic-tests">
                    <h3>åŸºç¡€åŠŸèƒ½æµ‹è¯•</h3>
                    <div class="uat-test-list">
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-1" onchange="updateTestStatus(this)">
                            <label for="test-1">åº”ç”¨å¯ä»¥æ­£å¸¸å¯åŠ¨å’Œåˆå§‹åŒ–</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-2" onchange="updateTestStatus(this)">
                            <label for="test-2">å¯ä»¥æ·»åŠ æ–°çš„å¾…åŠäº‹é¡¹</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-3" onchange="updateTestStatus(this)">
                            <label for="test-3">å¯ä»¥æ ‡è®°ä»»åŠ¡ä¸ºå·²å®Œæˆ</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-4" onchange="updateTestStatus(this)">
                            <label for="test-4">å¯ä»¥åˆ é™¤å¾…åŠäº‹é¡¹</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-5" onchange="updateTestStatus(this)">
                            <label for="test-5">ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤ºæ­£ç¡®</label>
                        </div>
                    </div>
                </div>

                <!-- æ•°æ®æŒä¹…åŒ–æµ‹è¯• -->
                <div class="uat-card" id="persistence-tests">
                    <h3>æ•°æ®æŒä¹…åŒ–æµ‹è¯•</h3>
                    <div class="uat-test-list">
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-6" onchange="updateTestStatus(this)">
                            <label for="test-6">åˆ·æ–°é¡µé¢åæ•°æ®ä¸ä¸¢å¤±</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-7" onchange="updateTestStatus(this)">
                            <label for="test-7">å…³é—­æµè§ˆå™¨åæ•°æ®ä¸ä¸¢å¤±</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-8" onchange="updateTestStatus(this)">
                            <label for="test-8">æ•°æ®æ ¼å¼æ­£ç¡®</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-9" onchange="updateTestStatus(this)">
                            <label for="test-9">æ”¯æŒå¤§é‡æ•°æ®å­˜å‚¨</label>
                        </div>
                    </div>
                </div>

                <!-- ç”¨æˆ·ä½“éªŒæµ‹è¯• -->
                <div class="uat-card" id="ux-tests">
                    <h3>ç”¨æˆ·ä½“éªŒæµ‹è¯•</h3>
                    <div class="uat-test-list">
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-10" onchange="updateTestStatus(this)">
                            <label for="test-10">ç•Œé¢ç®€æ´ç¾è§‚</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-11" onchange="updateTestStatus(this)">
                            <label for="test-11">æ“ä½œå“åº”åŠæ—¶</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-12" onchange="updateTestStatus(this)">
                            <label for="test-12">é”™è¯¯æç¤ºå‹å¥½</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-13" onchange="updateTestStatus(this)">
                            <label for="test-13">åŠ¨ç”»æ•ˆæœæµç•…</label>
                        </div>
                    </div>
                </div>

                <!-- å“åº”å¼è®¾è®¡æµ‹è¯• -->
                <div class="uat-card" id="responsive-tests">
                    <h3>å“åº”å¼è®¾è®¡æµ‹è¯•</h3>
                    <div class="uat-test-list">
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-14" onchange="updateTestStatus(this)">
                            <label for="test-14">æ¡Œé¢ç«¯æ˜¾ç¤ºæ­£å¸¸</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-15" onchange="updateTestStatus(this)">
                            <label for="test-15">å¹³æ¿ç«¯æ˜¾ç¤ºæ­£å¸¸</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-16" onchange="updateTestStatus(this)">
                            <label for="test-16">æ‰‹æœºç«¯æ˜¾ç¤ºæ­£å¸¸</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-17" onchange="updateTestStatus(this)">
                            <label for="test-17">ä¸åŒåˆ†è¾¨ç‡é€‚é…</label>
                        </div>
                    </div>
                </div>

                <!-- æ€§èƒ½æµ‹è¯• -->
                <div class="uat-card" id="performance-tests">
                    <h3>æ€§èƒ½æµ‹è¯•</h3>
                    <div class="uat-test-list">
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-18" onchange="updateTestStatus(this)">
                            <label for="test-18">åŠ è½½æ—¶é—´å°äº3ç§’</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-19" onchange="updateTestStatus(this)">
                            <label for="test-19">æ“ä½œå“åº”æ—¶é—´å°äº500ms</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-20" onchange="updateTestStatus(this)">
                            <label for="test-20">æ”¯æŒ1000ä¸ªä»»åŠ¡ä¸å¡é¡¿</label>
                        </div>
                    </div>
                </div>

                <!-- è¾¹ç•Œæƒ…å†µæµ‹è¯• -->
                <div class="uat-card" id="edge-case-tests">
                    <h3>è¾¹ç•Œæƒ…å†µæµ‹è¯•</h3>
                    <div class="uat-test-list">
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-21" onchange="updateTestStatus(this)">
                            <label for="test-21">ç©ºè¾“å…¥è¢«æ­£ç¡®å¤„ç†</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-22" onchange="updateTestStatus(this)">
                            <label for="test-22">è¶…é•¿æ–‡æœ¬è¢«æ­£ç¡®å¤„ç†</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-23" onchange="updateTestStatus(this)">
                            <label for="test-23">HTMLæ ‡ç­¾è¢«æ­£ç¡®è½¬ä¹‰</label>
                        </div>
                        <div class="uat-test-item">
                            <input type="checkbox" id="test-24" onchange="updateTestStatus(this)">
                            <label for="test-24">å­˜å‚¨ç©ºé—´ä¸è¶³æ—¶çš„å¤„ç†</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æµ‹è¯•åº”ç”¨åŒºåŸŸ -->
            <div class="uat-panel">
                <h2>æµ‹è¯•åº”ç”¨</h2>
                <p>è¯·åœ¨ä¸‹æ–¹åº”ç”¨ä¸­æ‰§è¡Œå„é¡¹æµ‹è¯•æ“ä½œï¼š</p>
                <div id="uat-app-container"></div>
            </div>

            <!-- æµ‹è¯•ç¬”è®° -->
            <div class="uat-panel">
                <h2>æµ‹è¯•ç¬”è®°</h2>
                <div class="uat-notes">
                    <h4>å‘ç°çš„é—®é¢˜</h4>
                    <textarea id="issues-notes" placeholder="è®°å½•æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°çš„é—®é¢˜..."></textarea>
                </div>
                <div class="uat-notes">
                    <h4>æ”¹è¿›å»ºè®®</h4>
                    <textarea id="suggestions-notes" placeholder="è®°å½•æ”¹è¿›å»ºè®®..."></textarea>
                </div>
                <div class="uat-notes">
                    <h4>å…¶ä»–å¤‡æ³¨</h4>
                    <textarea id="other-notes" placeholder="å…¶ä»–æµ‹è¯•å¤‡æ³¨..."></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥åº”ç”¨ç»„ä»¶ -->
    <script src="../js/storage.js"></script>
    <script src="../js/validator.js"></script>
    <script src="../js/manager.js"></script>
    <script src="../js/renderer.js"></script>
    <script src="../js/app.js"></script>

    <!-- UATæµ‹è¯•è„šæœ¬ -->
    <script>
        let uatResults = {
            startTime: null,
            endTime: null,
            tests: {},
            notes: {
                issues: '',
                suggestions: '',
                other: ''
            },
            environment: {}
        };

        // åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ
        function initUATEnvironment() {
            uatResults.environment = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                localStorage: typeof Storage !== 'undefined',
                screenResolution: `${screen.width}x${screen.height}`,
                viewportSize: `${window.innerWidth}x${window.innerHeight}`,
                timestamp: new Date().toISOString()
            };
        }

        // å¼€å§‹UATæµ‹è¯•
        function startUAT() {
            uatResults.startTime = new Date();
            initUATEnvironment();
            
            // åˆ›å»ºæµ‹è¯•åº”ç”¨å®ä¾‹
            createTestApp();
            
            // åˆå§‹åŒ–æ‰€æœ‰æµ‹è¯•é¡¹
            const testCheckboxes = document.querySelectorAll('.uat-test-item input[type="checkbox"]');
            testCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
                checkbox.disabled = false;
                uatResults.tests[checkbox.id] = {
                    completed: false,
                    passed: false,
                    timestamp: null
                };
            });
            
            updateProgress();
            alert('ç”¨æˆ·éªŒæ”¶æµ‹è¯•å·²å¼€å§‹ï¼Œè¯·åœ¨å³ä¾§åº”ç”¨ä¸­æ‰§è¡Œå„é¡¹æµ‹è¯•æ“ä½œï¼Œç„¶åå‹¾é€‰ç›¸åº”çš„æµ‹è¯•é¡¹ã€‚');
        }

        // åˆ›å»ºæµ‹è¯•åº”ç”¨
        function createTestApp() {
            const container = document.getElementById('uat-app-container');
            container.innerHTML = `
                <div class="container">
                    <header class="header">
                        <h1 class="app-title">å¾…åŠäº‹é¡¹ - æµ‹è¯•ç‰ˆ</h1>
                        <div class="stats">
                            <span class="stat-item">æ€»è®¡: <span id="uat-total-count">0</span></span>
                            <span class="stat-item">å·²å®Œæˆ: <span id="uat-completed-count">0</span></span>
                            <span class="stat-item">å¾…å®Œæˆ: <span id="uat-pending-count">0</span></span>
                        </div>
                    </header>
                    <main class="main">
                        <section class="input-section">
                            <div class="input-container">
                                <input type="text" id="uat-todo-input" class="todo-input" placeholder="æ·»åŠ æ–°çš„å¾…åŠäº‹é¡¹..." maxlength="200">
                                <button id="uat-add-btn" class="add-btn">æ·»åŠ </button>
                            </div>
                            <div id="uat-error-message" class="error-message"></div>
                        </section>
                        <section class="todo-section">
                            <div id="uat-todo-list" class="todo-list"></div>
                            <div id="uat-empty-state" class="empty-state">
                                <div class="empty-icon">ğŸ“</div>
                                <p class="empty-text">æš‚æ— å¾…åŠäº‹é¡¹</p>
                                <p class="empty-subtext">æ·»åŠ ä¸€ä¸ªæ–°ä»»åŠ¡å¼€å§‹å§ï¼</p>
                            </div>
                        </section>
                    </main>
                </div>
            `;

            // åˆå§‹åŒ–æµ‹è¯•åº”ç”¨
            const testApp = new TodoApp();
            testApp.initialize().then(() => {
                // ä¸ºæµ‹è¯•åº”ç”¨åˆ›å»ºç‹¬ç«‹çš„DOMå…ƒç´ 
                testApp.components.renderer.elements = {
                    todoInput: document.getElementById('uat-todo-input'),
                    addBtn: document.getElementById('uat-add-btn'),
                    todoList: document.getElementById('uat-todo-list'),
                    emptyState: document.getElementById('uat-empty-state'),
                    totalCount: document.getElementById('uat-total-count'),
                    completedCount: document.getElementById('uat-completed-count'),
                    pendingCount: document.getElementById('uat-pending-count'),
                    errorMessage: document.getElementById('uat-error-message')
                };
                
                // é‡æ–°ç»‘å®šäº‹ä»¶
                testApp.components.renderer.bindEvents();
                testApp.components.renderer.render();
            });
        }

        // æ›´æ–°æµ‹è¯•çŠ¶æ€
        function updateTestStatus(checkbox) {
            const testId = checkbox.id;
            const isCompleted = checkbox.checked;
            
            uatResults.tests[testId] = {
                completed: isCompleted,
                passed: isCompleted,
                timestamp: new Date().toISOString()
            };
            
            // æ›´æ–°UI
            const testItem = checkbox.closest('.uat-test-item');
            if (isCompleted) {
                testItem.classList.add('completed');
            } else {
                testItem.classList.remove('completed');
            }
            
            updateProgress();
            checkTestCategoryCompletion();
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const totalTests = Object.keys(uatResults.tests).length;
            const completedTests = Object.values(uatResults.tests).filter(test => test.completed).length;
            const passRate = totalTests > 0 ? Math.round((completedTests / totalTests) * 100) : 0;
            
            document.getElementById('total-tests').textContent = totalTests;
            document.getElementById('completed-tests').textContent = completedTests;
            document.getElementById('failed-tests').textContent = totalTests - completedTests;
            document.getElementById('pass-rate').textContent = passRate + '%';
            
            const progressBar = document.getElementById('progress-bar');
            progressBar.style.width = passRate + '%';
            progressBar.textContent = passRate + '%';
        }

        // æ£€æŸ¥æµ‹è¯•ç±»åˆ«å®Œæˆæƒ…å†µ
        function checkTestCategoryCompletion() {
            const categories = ['basic-tests', 'persistence-tests', 'ux-tests', 'responsive-tests', 'performance-tests', 'edge-case-tests'];
            
            categories.forEach(categoryId => {
                const category = document.getElementById(categoryId);
                const checkboxes = category.querySelectorAll('.uat-test-item input[type="checkbox"]');
                const totalCheckboxes = checkboxes.length;
                const completedCheckboxes = Array.from(checkboxes).filter(cb => cb.checked).length;
                
                if (totalCheckboxes > 0) {
                    const completionRate = completedCheckboxes / totalCheckboxes;
                    
                    if (completionRate === 1) {
                        category.classList.add('completed');
                        category.classList.remove('failed');
                    } else if (completionRate === 0) {
                        category.classList.remove('completed', 'failed');
                    } else {
                        category.classList.remove('completed', 'failed');
                    }
                }
            });
        }

        // é‡ç½®æµ‹è¯•
        function resetTests() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æµ‹è¯•ç»“æœå—ï¼Ÿ')) {
                // é‡ç½®æ‰€æœ‰å¤é€‰æ¡†
                const checkboxes = document.querySelectorAll('.uat-test-item input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                    checkbox.disabled = false;
                    const testItem = checkbox.closest('.uat-test-item');
                    testItem.classList.remove('completed');
                });
                
                // é‡ç½®æµ‹è¯•ç»“æœ
                uatResults = {
                    startTime: null,
                    endTime: null,
                    tests: {},
                    notes: {
                        issues: '',
                        suggestions: '',
                        other: ''
                    },
                    environment: {}
                };
                
                // é‡ç½®è¿›åº¦
                updateProgress();
                
                // é‡ç½®ç±»åˆ«çŠ¶æ€
                const categories = document.querySelectorAll('.uat-card');
                categories.forEach(category => {
                    category.classList.remove('completed', 'failed');
                });
                
                // æ¸…ç©ºç¬”è®°
                document.getElementById('issues-notes').value = '';
                document.getElementById('suggestions-notes').value = '';
                document.getElementById('other-notes').value = '';
            }
        }

        // å¯¼å‡ºç»“æœ
        function exportResults() {
            uatResults.endTime = new Date();
            uatResults.notes.issues = document.getElementById('issues-notes').value;
            uatResults.notes.suggestions = document.getElementById('suggestions-notes').value;
            uatResults.notes.other = document.getElementById('other-notes').value;
            
            const totalTests = Object.keys(uatResults.tests).length;
            const completedTests = Object.values(uatResults.tests).filter(test => test.completed).length;
            const passedTests = Object.values(uatResults.tests).filter(test => test.passed).length;
            
            const summary = {
                totalTests,
                completedTests,
                passedTests,
                passRate: totalTests > 0 ? Math.round((passedTests / totalTests) * 100) : 0,
                duration: uatResults.endTime - uatResults.startTime,
                testCompleted: completedTests === totalTests
            };
            
            const report = {
                summary,
                results: uatResults,
                generatedAt: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `uat-report-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ç”ŸæˆæŠ¥å‘Š
        function generateReport() {
            exportResults();
            
            const totalTests = Object.keys(uatResults.tests).length;
            const completedTests = Object.values(uatResults.tests).filter(test => test.completed).length;
            const passedTests = Object.values(uatResults.tests).filter(test => test.passed).length;
            const passRate = totalTests > 0 ? Math.round((passedTests / totalTests) * 100) : 0;
            
            let reportContent = `# ç”¨æˆ·éªŒæ”¶æµ‹è¯•æŠ¥å‘Š\n\n`;
            reportContent += `## æµ‹è¯•æ¦‚è§ˆ\n`;
            reportContent += `- **æµ‹è¯•æ—¶é—´**: ${new Date().toLocaleString()}\n`;
            reportContent += `- **æµ‹è¯•ç¯å¢ƒ**: ${uatResults.environment.platform} - ${uatResults.environment.userAgent}\n`;
            reportContent += `- **æ€»æµ‹è¯•é¡¹**: ${totalTests}\n`;
            reportContent += `- **å·²å®Œæˆ**: ${completedTests}\n`;
            reportContent += `- **é€šè¿‡**: ${passedTests}\n`;
            reportContent += `- **é€šè¿‡ç‡**: ${passRate}%\n\n`;
            
            if (uatResults.notes.issues) {
                reportContent += `## å‘ç°çš„é—®é¢˜\n${uatResults.notes.issues}\n\n`;
            }
            
            if (uatResults.notes.suggestions) {
                reportContent += `## æ”¹è¿›å»ºè®®\n${uatResults.notes.suggestions}\n\n`;
            }
            
            if (uatResults.notes.other) {
                reportContent += `## å…¶ä»–å¤‡æ³¨\n${uatResults.notes.other}\n\n`;
            }
            
            reportContent += `## ç»“è®º\n`;
            if (passRate >= 90) {
                reportContent += `åº”ç”¨è´¨é‡ä¼˜ç§€ï¼Œå¯ä»¥æ­£å¼å‘å¸ƒã€‚\n`;
            } else if (passRate >= 70) {
                reportContent += `åº”ç”¨è´¨é‡è‰¯å¥½ï¼Œå»ºè®®ä¿®å¤å‘ç°çš„é—®é¢˜åå‘å¸ƒã€‚\n`;
            } else {
                reportContent += `åº”ç”¨éœ€è¦è¿›ä¸€æ­¥æ”¹è¿›ï¼Œå»ºè®®è§£å†³å…³é”®é—®é¢˜åå†å‘å¸ƒã€‚\n`;
            }
            
            const blob = new Blob([reportContent], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `uat-report-${new Date().toISOString().split('T')[0]}.md`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            initUATEnvironment();
            
            // åˆå§‹åŒ–æ‰€æœ‰æµ‹è¯•é¡¹
            const testCheckboxes = document.querySelectorAll('.uat-test-item input[type="checkbox"]');
            testCheckboxes.forEach(checkbox => {
                checkbox.disabled = true;
                uatResults.tests[checkbox.id] = {
                    completed: false,
                    passed: false,
                    timestamp: null
                };
            });
            
            updateProgress();
        });
    </script>
</body>
</html>